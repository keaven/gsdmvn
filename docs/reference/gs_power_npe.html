<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Group sequential bound computation with non-constant effect — gs_power_npe • gsdmvn</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Group sequential bound computation with non-constant effect — gs_power_npe" />
<meta property="og:description" content="gs_power_npe() derives group sequential bounds and boundary crossing probabilities for a design.
It allows a non-constant treatment effect over time, but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and statistical information at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package: 1) non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function gs_design_nph() will be used; it calls this function.
Initial bound types supported are 1) spending bounds, 2) fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by gs_power_npe()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsdmvn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/DesignWithSpending.html">Trial design with spending under NPH</a>
    </li>
    <li>
      <a href="../articles/NPEbackground.html">Non-Proportional Effect Size in Group Sequential Design</a>
    </li>
    <li>
      <a href="../articles/NPEbounds.html">Computing Bounds Under Non-Constant Treatment Effect</a>
    </li>
    <li>
      <a href="../articles/QuickStart.html">Quick Start for NPH Sample Size and Power</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Group sequential bound computation with non-constant effect</h1>
    
    <div class="hidden name"><code>gs_power_npe.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>gs_power_npe()</code> derives group sequential bounds and boundary crossing probabilities for a design.
It allows a non-constant treatment effect over time, but also can be applied for the usual homogeneous effect size designs.
It requires treatment effect and statistical information at each analysis as well as a method of deriving bounds, such as spending.
The routine enables two things not available in the gsDesign package: 1) non-constant effect, 2) more flexibility in boundary selection.
For many applications, the non-proportional-hazards design function <code><a href='gs_design_nph.html'>gs_design_nph()</a></code> will be used; it calls this function.
Initial bound types supported are 1) spending bounds, 2) fixed bounds, and 3) Haybittle-Peto-like bounds.
The requirement is to have a boundary update method that can each bound without knowledge of future bounds.
As an example, bounds based on conditional power that require knowledge of all future bounds are not supported by this routine;
a more limited conditional power method will be demonstrated.
Boundary family designs Wang-Tsiatis designs including the original (non-spending-function-based) O'Brien-Fleming and Pocock designs
are not supported by <code>gs_power_npe()</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>gs_power_npe</span>(
  <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>theta1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>info</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>info1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>info0</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>binding</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>gs_b</span>,
  <span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>gs_b</span>,
  <span class='kw'>upar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='fl'>0.975</span>),
  <span class='kw'>lpar</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>,
  <span class='kw'>test_upper</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>test_lower</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>r</span> <span class='kw'>=</span> <span class='fl'>18</span>,
  <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-06</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>theta</th>
      <td><p>natural parameter for group sequential design representing
expected incremental drift at all analyses; used for power calculation</p></td>
    </tr>
    <tr>
      <th>theta1</th>
      <td><p>natural parameter for alternate hypothesis, if needed for lower bound computation</p></td>
    </tr>
    <tr>
      <th>info</th>
      <td><p>statistical information at all analyses for input <code>theta</code></p></td>
    </tr>
    <tr>
      <th>info1</th>
      <td><p>statistical information under hypothesis used for futility bound calculation if different from
<code>info</code>; impacts futility hypothesis bound calculation</p></td>
    </tr>
    <tr>
      <th>info0</th>
      <td><p>statistical information under null hypothesis, if different than <code>info</code>;
impacts null hypothesis bound calculation</p></td>
    </tr>
    <tr>
      <th>binding</th>
      <td><p>indicator of whether futility bound is binding; default of FALSE is recommended</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>function to compute upper bound</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>function to compare lower bound</p></td>
    </tr>
    <tr>
      <th>upar</th>
      <td><p>parameter to pass to upper</p></td>
    </tr>
    <tr>
      <th>lpar</th>
      <td><p>parameter to pass to lower</p></td>
    </tr>
    <tr>
      <th>test_upper</th>
      <td><p>indicator of which analyses should include an upper (efficacy) bound;
single value of TRUE (default)  indicates all analyses; otherwise,
a logical vector of the same length as <code>info</code> should indicate which analyses will have an efficacy bound</p></td>
    </tr>
    <tr>
      <th>test_lower</th>
      <td><p>indicator of which analyses should include a lower bound;
single value of TRUE (default) indicates all analyses;
single value FALSE indicated no lower bound; otherwise,
a logical vector of the same length as <code>info</code> should indicate which analyses will have a lower bound</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>Integer, at least 2; default of 18 recommended by Jennison and Turnbull</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance parameter for boundary convergence (on Z-scale)</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>gsDesign</span>)
<span class='co'># Default (single analysis; Type I error controlled)</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span><span class='kw'>=</span><span class='fl'>0</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span>(<span class='no'>Bound</span><span class='kw'>==</span><span class='st'>"Upper"</span>)</div><div class='output co'>#&gt; # A tibble: 1 x 9
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  1.96       0.025     0      0     1     1     1</div><div class='input'>
<span class='co'># Fixed bound</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>, <span class='kw'>info0</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>,
              <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>gs_b</span>, <span class='kw'>upar</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gsDesign/man/gsDesign.html'>gsDesign</a></span>(<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>3</span>,<span class='kw'>sfu</span><span class='kw'>=</span><span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>)$<span class='no'>upper</span>$<span class='no'>bound</span>,
              <span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>gs_b</span>, <span class='kw'>lpar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  3.71     0.00104   0.1    0.1    40    40    40
#&gt; 2        2 Upper  2.51     0.235     0.2    0.2    80    80    80
#&gt; 3        3 Upper  1.99     0.869     0.3    0.3   120   120   120
#&gt; 4        1 Lower -1        0.0513    0.1    0.1    40    40    40
#&gt; 5        2 Lower  0        0.0715    0.2    0.2    80    80    80
#&gt; 6        3 Lower  0        0.0715    0.3    0.3   120   120   120</div><div class='input'>
<span class='co'># Same fixed efficacy bounds, no futility bound (i.e., non-binding bound), null hypothesis</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>,<span class='fl'>3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>,
<span class='kw'>upar</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gsDesign/man/gsDesign.html'>gsDesign</a></span>(<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>3</span>,<span class='kw'>sfu</span><span class='kw'>=</span><span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>)$<span class='no'>upper</span>$<span class='no'>bound</span>,
<span class='kw'>lpar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(-<span class='fl'>Inf</span>, <span class='fl'>3</span>)) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span>(<span class='no'>Bound</span><span class='kw'>==</span><span class='st'>"Upper"</span>)</div><div class='output co'>#&gt; # A tibble: 3 x 9
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  3.71    0.000104     0      0    40    40    40
#&gt; 2        2 Upper  2.51    0.00605      0      0    80    80    80
#&gt; 3        3 Upper  1.99    0.0250       0      0   120   120   120</div><div class='input'>
<span class='co'># Fixed bound with futility only at analysis 1; efficacy only at analyses 2, 3</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>, <span class='kw'>upar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>Inf</span>, <span class='fl'>3</span>, <span class='fl'>2</span>), <span class='kw'>lpar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='fl'>.1</span>), -<span class='fl'>Inf</span>, -<span class='fl'>Inf</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   Analysis Bound       Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  Inf         0        0.1    0.1    40    40    40
#&gt; 2        2 Upper    3         0.113    0.2    0.2    80    80    80
#&gt; 3        3 Upper    2         0.887    0.3    0.3   120   120   120
#&gt; 4        1 Lower   -1.28      0.0278   0.1    0.1    40    40    40
#&gt; 5        2 Lower -Inf         0.0278   0.2    0.2    80    80    80
#&gt; 6        3 Lower -Inf         0.0278   0.3    0.3   120   120   120</div><div class='input'>
<span class='co'># Spending function bounds</span>
<span class='co'># Lower spending based on non-zero effect</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>,
             <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>gs_spending_bound</span>,
             <span class='kw'>upar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sf</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, <span class='kw'>total_spend</span> <span class='kw'>=</span> <span class='fl'>0.025</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>timing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>),
             <span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>gs_spending_bound</span>,
             <span class='kw'>lpar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sf</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfHSD.html'>sfHSD</a></span>, <span class='kw'>total_spend</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>param</span> <span class='kw'>=</span> -<span class='fl'>1</span>, <span class='kw'>timing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   Analysis Bound       Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  3.71       0.00104   0.1    0.1    40    40    40
#&gt; 2        2 Upper  2.51       0.235     0.2    0.2    80    80    80
#&gt; 3        3 Upper  1.99       0.883     0.3    0.3   120   120   120
#&gt; 4        1 Lower -1.36       0.0230    0.1    0.1    40    40    40
#&gt; 5        2 Lower  0.0726     0.0552    0.2    0.2    80    80    80
#&gt; 6        3 Lower  1.86       0.1       0.3    0.3   120   120   120</div><div class='input'>
<span class='co'># Same bounds, but power under different theta</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.15</span>, <span class='fl'>.25</span>, <span class='fl'>.35</span>), <span class='kw'>theta1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>,
             <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>gs_spending_bound</span>,
             <span class='kw'>upar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sf</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, <span class='kw'>total_spend</span> <span class='kw'>=</span> <span class='fl'>0.025</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>timing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>),
             <span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>gs_spending_bound</span>,
             <span class='kw'>lpar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sf</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfHSD.html'>sfHSD</a></span>, <span class='kw'>total_spend</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>param</span> <span class='kw'>=</span> -<span class='fl'>1</span>, <span class='kw'>timing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>))</div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   Analysis Bound       Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  3.71       0.00288  0.15    0.1    40    40    40
#&gt; 2        2 Upper  2.51       0.392    0.25    0.2    80    80    80
#&gt; 3        3 Upper  1.99       0.956    0.35    0.3   120   120   120
#&gt; 4        1 Lower -1.36       0.0104   0.15    0.1    40    40    40
#&gt; 5        2 Lower  0.0726     0.0221   0.25    0.2    80    80    80
#&gt; 6        3 Lower  1.86       0.0370   0.35    0.3   120   120   120</div><div class='input'>
<span class='co'># Two-sided symmetric spend, O'Brien-Fleming spending</span>
<span class='co'># Typically, 2-sided bounds are binding</span>
<span class='no'>xx</span> <span class='kw'>&lt;-</span> <span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>), <span class='kw'>theta1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='fl'>3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>,
                   <span class='kw'>upper</span> <span class='kw'>=</span> <span class='no'>gs_spending_bound</span>,
                   <span class='kw'>binding</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                   <span class='kw'>upar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sf</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, <span class='kw'>total_spend</span> <span class='kw'>=</span> <span class='fl'>0.025</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>timing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>),
                   <span class='kw'>lower</span> <span class='kw'>=</span> <span class='no'>gs_spending_bound</span>,
                   <span class='kw'>lpar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>sf</span> <span class='kw'>=</span> <span class='kw pkg'>gsDesign</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/gsDesign/man/sfLDOF.html'>sfLDOF</a></span>, <span class='kw'>total_spend</span> <span class='kw'>=</span> <span class='fl'>0.025</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>timing</span> <span class='kw'>=</span> <span class='kw'>NULL</span>))
<span class='no'>xx</span></div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  3.71    0.000104     0      0    40    40    40
#&gt; 2        2 Upper  2.51    0.00605      0      0    80    80    80
#&gt; 3        3 Upper  1.99    0.0250       0      0   120   120   120
#&gt; 4        1 Lower -3.71    0.000104     0      0    40    40    40
#&gt; 5        2 Lower -2.51    0.00605      0      0    80    80    80
#&gt; 6        3 Lower -1.99    0.0250       0      0   120   120   120</div><div class='input'>
<span class='co'># Re-use these bounds under alternate hypothesis</span>
<span class='co'># Always use binding = TRUE for power calculations</span>
<span class='no'>upar</span> <span class='kw'>&lt;-</span> (<span class='no'>xx</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span>(<span class='no'>Bound</span><span class='kw'>==</span><span class='st'>"Upper"</span>))$<span class='no'>Z</span>
<span class='fu'>gs_power_npe</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.1</span>, <span class='fl'>.2</span>, <span class='fl'>.3</span>), <span class='kw'>info</span> <span class='kw'>=</span> (<span class='fl'>1</span>:<span class='fl'>3</span>) * <span class='fl'>40</span>,
             <span class='kw'>binding</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
             <span class='kw'>upar</span> <span class='kw'>=</span> <span class='no'>upar</span>,
             <span class='kw'>lpar</span> <span class='kw'>=</span> -<span class='no'>upar</span>)</div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt;   Analysis Bound     Z Probability theta theta1  info info0 info1
#&gt;      &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1 Upper  3.71  0.00104      0.1    0.1    40    40    40
#&gt; 2        2 Upper  2.51  0.235        0.2    0.2    80    80    80
#&gt; 3        3 Upper  1.99  0.902        0.3    0.3   120   120   120
#&gt; 4        1 Lower -3.71  0.00000704   0.1    0.1    40    40    40
#&gt; 5        2 Lower -2.51  0.0000151    0.2    0.2    80    80    80
#&gt; 6        3 Lower -1.99  0.0000151    0.3    0.3   120   120   120</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


